<!DOCTYPE html>
<html lang="en">

<head>
    <title>HeroZero – XIRR Calculator</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="google-adsense-account" content="ca-pub-2137440189333906">
    <meta name="description" content="XIRR calculator for irregular cash flows — estimate the annualized return for a series of dated investments and withdrawals.">
    <meta name="keywords" content="xirr calculator, irregular cashflows, internal rate of return, investment return calculator, India">
    <link rel="apple-touch-icon" sizes="180x180" href="https://herozero.in/assets/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://herozero.in/assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://herozero.in/assets/img/favicon-16x16.png">
    <link rel="manifest" href="https://herozero.in/site.webmanifest">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/zephyr/bootstrap.min.css"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
        crossorigin="anonymous">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2137440189333906"
        crossorigin="anonymous"></script>
    <script type="application/ld+json">
        {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "HeroZero - XIRR Calculator",
        "url": "https://herozero.in/pages/calculators/xirr-calculator.html"
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark">
        <div class="container">
            <a class="navbar-brand fw-bold" href="https://herozero.in/index.html">
                <img src="https://herozero.in/assets/img/favicon-32x32.png" class="me-2" alt="HeroZero Logo">HeroZero
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link active" href="https://herozero.in/"><i
                                class="bi bi-house-fill me-2"></i>Home</a></li>
                    <li class="nav-item dropdown" data-bs-theme="light"><a class="nav-link active dropdown-toggle"
                            data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                            aria-expanded="false">Calculators</a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/car-affordability.html"><i
                                    class="bi bi-car-front-fill"></i> Car Affordability</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/house-affordability.html"><i
                                    class="bi bi-house-door-fill"></i> House Affordability</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/mobile-affordability.html"><i
                                    class="bi bi-phone"></i> Mobile Affordability</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/stock-average-price.html"><i
                                    class="bi bi-bar-chart-line-fill"></i> Stock Average Price</a>
                            <a class="dropdown-item" href="https://herozero.in/pages/calculators/sip-calculator.html"><i
                                    class="bi bi-cash-stack"></i> SIP Calculator</a>
                            <a class="dropdown-item" href="https://herozero.in/pages/calculators/sip-goal.html"><i
                                    class="bi bi-bullseye"></i> SIP Goal Planner</a>
                            <a class="dropdown-item" href="https://herozero.in/pages/calculators/lumpsum-return.html"><i
                                    class="bi bi-coin"></i> Lumpsum Return</a>
                            <a class="dropdown-item" href="https://herozero.in/pages/calculators/sip-vs-lumpsum.html"><i
                                    class="bi bi-sliders"></i> SIP vs Lumpsum</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/xirr-calculator.html"><i
                                    class="bi bi-calculator"></i> XIRR (cashflows)</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/capital-gains-estimator.html"><i
                                    class="bi bi-graph-up"></i> Capital Gains Estimator</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/portfolio-rebalance.html"><i
                                    class="bi bi-vector-pen"></i> Portfolio Rebalancer</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/expense-ratio-impact.html"><i
                                    class="bi bi-percent"></i> Expense Ratio Impact</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/sip-topup-planner.html"><i
                                    class="bi bi-arrow-repeat"></i> SIP Top-up Planner</a>
                            <a class="dropdown-item" href="https://herozero.in/pages/calculators/swp-withdrawal.html"><i
                                    class="bi bi-wallet2"></i> SWP / Withdrawal Planner</a>
                            <a class="dropdown-item"
                                href="https://herozero.in/pages/calculators/mf-switch-estimator.html"><i
                                    class="bi bi-arrow-left-right"></i> MF Switch / Exit Estimator</a>
                        </div>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="/pages/blog.html"><i
                                class="bi bi-journal-text me-2"></i>Blog</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <main class="container" style="margin-top:5.5rem">
        <div class="row">
            <div class="col-lg-8 offset-lg-2">
                <h1>XIRR (internal rate of return)</h1>
                <p class="text-muted">Estimate XIRR for a series of cash flows. Enter negative for investments and
                    positive for returns.</p>
                <div class="card p-3">
                    <div class="mb-2"><small class="text-muted">Enter cash flows in the rows below. Use date format <strong>dd-mm-yyyy</strong>. Use negative amounts for money you put in and positive for money you get back.</small></div>

                    <div class="table-responsive mt-2">
                        <table class="table table-sm table-bordered" id="cashflowTable">
                            <thead>
                                <tr>
                                    <th style="width:32px;"></th>
                                    <th style="width:140px">Date (dd-mm-yyyy)</th>
                                    <th>Amount (₹)</th>
                                    <th style="width:100px">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="cf-row">
                                    <td class="text-center"><input type="checkbox" class="select-row" /></td>
                                    <td><input type="date" class="form-control cf-date" value="2020-01-01" placeholder="dd-mm-yyyy"></td>
                                    <td><input type="number" class="form-control cf-amount" value="-10000"></td>
                                    <td><button class="btn btn-sm btn-outline-danger remove-row">Remove</button></td>
                                </tr>
                                <tr class="cf-row">
                                    <td class="text-center"><input type="checkbox" class="select-row" /></td>
                                    <td><input type="date" class="form-control cf-date" value="2020-04-01" placeholder="dd-mm-yyyy"></td>
                                    <td><input type="number" class="form-control cf-amount" value="-10000"></td>
                                    <td><button class="btn btn-sm btn-outline-danger remove-row">Remove</button></td>
                                </tr>
                                <tr class="cf-row">
                                    <td class="text-center"><input type="checkbox" class="select-row" /></td>
                                    <td><input type="date" class="form-control cf-date" value="2023-01-01" placeholder="dd-mm-yyyy"></td>
                                    <td><input type="number" class="form-control cf-amount" value="50000"></td>
                                    <td><button class="btn btn-sm btn-outline-danger remove-row">Remove</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="d-flex gap-2 mt-2">
                        <button id="addRowBtn" class="btn btn-sm btn-secondary">Add row</button>
                        <button id="removeSelectedBtn" class="btn btn-sm btn-danger">Remove selected</button>
                        <div class="ms-auto">
                            <button id="calcBtn" class="btn btn-primary">Calculate XIRR</button>
                        </div>
                    </div>

                    <hr />
                    <h4 class="mb-1 d-none text-center" id="xirr-p"><strong>XIRR (annual %):</strong> <span id="xirr"></span></h4>
                    <p id="xirrError" class="text-danger small d-none"></p>
                    <div class="mt-3 d-flex align-items-center d-none">
                        <label class="me-2 mb-0">Chart type:</label>
                        <select id="chartType" class="form-select form-select-sm" style="width:160px;">
                            <option value="line">Line (value over time)</option>
                            <option value="bar">Bar (value per date)</option>
                            <option value="area">Area (filled line)</option>
                        </select>
                        <div class="ms-auto">
                            <button id="downloadChart" class="btn btn-sm btn-outline-secondary">Download Chart</button>
                        </div>
                    </div>
                    <div class="mt-3">
                        <canvas id="xirrChart" class="d-none" height="140"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script>
        // parse date in dd-mm-yyyy -> Date object
        function parseDMY(s) {
            if (!s) return null;
            // if format is yyyy-mm-dd (from input[type=date])
            if (/^\d{4}-\d{2}-\d{2}$/.test(s)) {
                const parts = s.split('-');
                const y = parseInt(parts[0], 10);
                const m = parseInt(parts[1], 10) - 1;
                const d = parseInt(parts[2], 10);
                const dt = new Date(y, m, d);
                if (dt.getFullYear() !== y || dt.getMonth() !== m || dt.getDate() !== d) return null;
                return dt;
            }
            // accept dd-mm-yyyy as fallback
            const parts = s.split('-').map(p => p.trim());
            if (parts.length !== 3) return null;
            const d = parseInt(parts[0], 10);
            const m = parseInt(parts[1], 10) - 1;
            const y = parseInt(parts[2], 10);
            if (!Number.isFinite(d) || !Number.isFinite(m) || !Number.isFinite(y)) return null;
            const dt = new Date(y, m, d);
            if (dt.getFullYear() !== y || dt.getMonth() !== m || dt.getDate() !== d) return null;
            return dt;
        }

        function collectCashflows() {
            const rows = Array.from(document.querySelectorAll('#cashflowTable tbody .cf-row'));
            const cfs = [];
            for (const r of rows) {
                const dateStr = r.querySelector('.cf-date').value.trim();
                const amtStr = r.querySelector('.cf-amount').value;
                if (!dateStr) continue;
                const dt = parseDMY(dateStr);
                const amt = parseFloat(amtStr);
                if (!dt || !Number.isFinite(amt)) continue;
                cfs.push({ date: dt, amount: amt });
            }
            cfs.sort((a, b) => a.date - b.date);
            return cfs;
        }

        // build cumulative value series for charting
        function buildValueSeries(cashflows, annualRateEstimate) {
            // create unique sorted dates and cumulative invested/value
            const msPerDay = 24 * 60 * 60 * 1000;
            const out = [];
            if (cashflows.length === 0) return out;
            // approximate growth between cashflows using estimated rate
            let balance = 0;
            let lastDate = cashflows[0].date;
            for (const cf of cashflows) {
                // grow balance from lastDate to cf.date
                const years = (cf.date - lastDate) / msPerDay / 365.0;
                if (years > 0 && balance !== 0) {
                    balance = balance * Math.pow(1 + annualRateEstimate, years);
                }
                balance += cf.amount;
                out.push({ date: new Date(cf.date), value: balance });
                lastDate = cf.date;
            }
            return out;
        }

        function xnpv(rate, cashflows) {
            let pv = 0;
            const msPerDay = 24 * 60 * 60 * 1000;
            const firstDate = cashflows[0].date;
            for (const cf of cashflows) {
                const t = (cf.date - firstDate) / msPerDay / 365.0;
                pv += cf.amount / Math.pow(1 + rate, t);
            }
            return pv;
        }

        function xirr(cashflows) {
            if (cashflows.length === 0) throw new Error('no cashflows');
            let guess = 0.1;
            for (let i = 0; i < 200; i++) {
                const f = xnpv(guess, cashflows);
                const eps = 1e-7;
                const f1 = xnpv(guess + eps, cashflows);
                const deriv = (f1 - f) / eps;
                if (Math.abs(deriv) < 1e-12) break;
                const newGuess = guess - f / deriv;
                if (!isFinite(newGuess)) break;
                if (Math.abs(newGuess - guess) < 1e-9) { guess = newGuess; break; }
                guess = newGuess;
            }
            return guess;
        }

        function addRow(date = '', amount = '') {
            const tbody = document.querySelector('#cashflowTable tbody');
            const tr = document.createElement('tr');
            tr.className = 'cf-row';
            tr.innerHTML = `
                <td class="text-center"><input type="checkbox" class="select-row" /></td>
                <td><input type="date" class="form-control cf-date" value="${date}" placeholder="dd-mm-yyyy"></td>
                <td><input type="number" class="form-control cf-amount" value="${amount}"></td>
                <td><button class="btn btn-sm btn-outline-danger remove-row">Remove</button></td>
            `;
            tbody.appendChild(tr);
            tr.querySelector('.remove-row').addEventListener('click', () => tr.remove());
        }

        document.getElementById('addRowBtn').addEventListener('click', () => addRow('', ''));
        document.getElementById('removeSelectedBtn').addEventListener('click', () => {
            const checks = document.querySelectorAll('#cashflowTable .select-row:checked');
            checks.forEach(cb => { const row = cb.closest('tr'); if (row) row.remove(); });
        });

        document.querySelectorAll('.remove-row').forEach(btn => btn.addEventListener('click', (e) => {
            const tr = e.target.closest('tr'); if (tr) tr.remove();
        }));

        document.getElementById('calcBtn').addEventListener('click', () => {
            const errEl = document.getElementById('xirrError');
            errEl.classList.add('d-none');
            errEl.innerText = '';
            const rawCF = collectCashflows();
            if (rawCF.length < 2) { errEl.innerText = 'Enter at least two valid cash flows.'; errEl.classList.remove('d-none'); return; }
            const cfs = rawCF.map(cf => ({ date: cf.date, amount: cf.amount }));
            try {
                const r = xirr(cfs);
                if (!isFinite(r)) throw new Error('no convergence');
                document.getElementById('xirr').innerText = (r * 100).toFixed(2);
                // draw chart using series built from cashflows and xirr as estimate
                try { drawChart(cfs, r); } catch (e) { console.log('chart error', e); }
            } catch (e) {
                document.getElementById('xirr').innerText = 'Error';
                errEl.innerText = 'Could not compute XIRR. Check dates are valid and amounts are numbers.';
                errEl.classList.remove('d-none');
            }
        });

        // Chart.js drawing
        let xirrChart = null;
        function drawChart(cashflows, annualRate) {
            document.getElementById('xirrChart').classList.remove('d-none');
            document.getElementById('xirr-p').classList.remove('d-none');
            const chartType = document.getElementById('chartType').value;
            // build series using annualRate as estimate
            const series = buildValueSeries(cashflows, annualRate);
            const labels = series.map(s => s.date.toISOString().slice(0, 10));
            const data = series.map(s => s.value);
            const ctx = document.getElementById('xirrChart');
            if (xirrChart) xirrChart.destroy();
            const config = {
                type: chartType === 'bar' ? 'bar' : 'line',
                data: {
                    labels,
                    datasets: [{ label: 'Estimated value (₹)', data, borderColor: '#198754', backgroundColor: chartType === 'bar' ? '#198754' : 'rgba(25,135,84,0.08)', fill: chartType !== 'bar' }]
                },
                options: { responsive: true, plugins: { legend: { position: 'top' }, tooltip: { callbacks: { label: (ctx) => '₹' + Number(ctx.parsed.y).toLocaleString('en-IN') } } }, scales: { y: { ticks: { callback: (v) => '₹' + Number(v).toLocaleString('en-IN') } } } }
            };
            xirrChart = new Chart(ctx, config);
        }

        document.getElementById('downloadChart').addEventListener('click', () => {
            if (!xirrChart) return;
            const a = document.createElement('a');
            a.href = xirrChart.toBase64Image();
            a.download = 'xirr-chart.png';
            a.click();
        });
    </script>

    <!-- Simple explanation for novices about XIRR -->
    <div class="container" style="margin-top:1rem">
        <div class="row">
            <div class="col-lg-8 offset-lg-2">
                <div class="card mt-3 p-4">
                    <h2>What is XIRR? (in simple words)</h2>
                    <p class="mb-2">XIRR is a way to show the yearly return you earned when you have many investments and withdrawals at different times. It gives one annual percentage that sums up the whole story.</p>

                    <h3>How it helps</h3>
                    <p class="mb-2">If you invested several times and later took money out, XIRR tells you the effective yearly return across those dates. Use negative numbers for money you invest and positive for money you receive back.</p>

                    <h3>Simple example</h3>
                    <p class="mb-2">If you put in ₹10,000 on 01-01-2020, another ₹10,000 on 01-04-2020 and got ₹50,000 on 01-01-2023, the calculator will give a single yearly return number for that series.</p>

                    <p class="text-muted small mb-0">This is an estimate and depends on the dates and amounts you enter. It helps compare returns when cash flows are irregular.</p>
                </div>
            </div>
        </div>
    </div>
    <footer class="bg-primary text-white text-center py-3 mt-5">
        <nav class="mb-2">
            <a class="text-white mx-2" href="https://herozero.in/pages/about.html">About</a>
            <a class="text-white mx-2" href="https://herozero.in/pages/contact.html">Contact</a>
            <a class="text-white mx-2" href="https://herozero.in/pages/privacy-policy.html">Privacy Policy</a>
            <a class="text-white mx-2" href="https://herozero.in/pages/terms-of-use.html">Terms of Use</a>
            <a class="text-white mx-2" href="https://herozero.in/pages/disclaimer.html">Disclaimer</a>
        </nav>
        <small>&copy; 2025 HeroZero. All Rights Reserved.</small>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>
</body>

</html>